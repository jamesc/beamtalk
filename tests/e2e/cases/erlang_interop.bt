// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// E2E tests for Erlang interop in the REPL context (ADR 0028, BT-677)
//
// This file covers REPL-specific behavior only.
// Proxy construction and function call semantics are tested exhaustively in
// stdlib/test/erlang_interop_test.bt (BUnit).

// ===========================================================================
// CACHED PROXY VIA WORKSPACE BINDING (cross-turn persistence)
// ===========================================================================

// Store proxy in workspace variable across turns
proxy := Erlang lists
// => #ErlangModule<lists>

// Reuse stored proxy in the next turn
proxy reverse: #(10, 20, 30)
// => [30,20,10]

// Proxy class survives across turns
proxy class
// => ErlangModule

// ===========================================================================
// ERLANG INTEROP INSIDE ACTOR METHODS (REPL workspace binding)
// ===========================================================================

// @load tests/e2e/fixtures/erlang_user.bt

eu := ErlangUser spawn
// => _

// Actor method calls Erlang internally and stores the result in state
// callErlang assigns self.result := Erlang lists reverse: #(1,2,3), returning [3,2,1]
eu callErlang await
// => [3,2,1]

eu getResult await
// => [3,2,1]
