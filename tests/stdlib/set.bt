// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// E2E tests for Set (unique element collections using ordsets) (BT-73)

// ===========================================================================
// CREATION & CLASS
// ===========================================================================

Set new
// => {"$beamtalk_class":"Set","elements":[]}

(Set new) class
// => Set

// ===========================================================================
// ISEMPTY & SIZE
// ===========================================================================

(Set new) isEmpty
// => true

(Set new) size
// => 0

// ===========================================================================
// ADD & INCLUDES
// ===========================================================================

s := (Set new) add: 1
// => {"$beamtalk_class":"Set","elements":[1]}

s includes: 1
// => true

s includes: 2
// => false

s size
// => 1

// ===========================================================================
// ADD DEDUPLICATION
// ===========================================================================

s2 := (s add: 2) add: 1
// => {"$beamtalk_class":"Set","elements":[1,2]}

s2 size
// => 2

s2 includes: 1
// => true

s2 includes: 2
// => true

// ===========================================================================
// REMOVE
// ===========================================================================

s3 := s2 remove: 1
// => {"$beamtalk_class":"Set","elements":[2]}

s3 includes: 1
// => false

s3 includes: 2
// => true

s3 size
// => 1

// ===========================================================================
// FROMLIST (instance method creating new set from list)
// ===========================================================================

colors := (Set new) fromList: #(#red, #green, #blue)
// => {"$beamtalk_class":"Set","elements":["blue","green","red"]}

colors size
// => 3

colors includes: #red
// => true

colors includes: #yellow
// => false

// ===========================================================================
// UNION
// ===========================================================================

a := (Set new) fromList: #(1, 2, 3)
// => {"$beamtalk_class":"Set","elements":[1,2,3]}

b := (Set new) fromList: #(3, 4, 5)
// => {"$beamtalk_class":"Set","elements":[3,4,5]}

u := a union: b
// => {"$beamtalk_class":"Set","elements":[1,2,3,4,5]}

u size
// => 5

u includes: 1
// => true

u includes: 5
// => true

// ===========================================================================
// INTERSECTION
// ===========================================================================

i := a intersection: b
// => {"$beamtalk_class":"Set","elements":[3]}

i size
// => 1

i includes: 3
// => true

i includes: 1
// => false

// ===========================================================================
// DIFFERENCE
// ===========================================================================

d := a difference: b
// => {"$beamtalk_class":"Set","elements":[1,2]}

d size
// => 2

d includes: 1
// => true

d includes: 3
// => false

// ===========================================================================
// ISSUBSETOF
// ===========================================================================

small := (Set new) fromList: #(1, 2)
// => {"$beamtalk_class":"Set","elements":[1,2]}

big := (Set new) fromList: #(1, 2, 3)
// => {"$beamtalk_class":"Set","elements":[1,2,3]}

small isSubsetOf: big
// => true

big isSubsetOf: small
// => false

// ===========================================================================
// ASLIST
// ===========================================================================

(Set new) fromList: #(3, 1, 2)
// => {"$beamtalk_class":"Set","elements":[1,2,3]}

((Set new) fromList: #(3, 1, 2)) asList
// => [1,2,3]

// ===========================================================================
// ITERATION
// ===========================================================================

((Set new) fromList: #(1, 2, 3)) do: [:x | nil]
// => nil

// ===========================================================================
// RESPONDSTO (method reflection)
// ===========================================================================

s4 := (Set new) add: 1
// => {"$beamtalk_class":"Set","elements":[1]}

s4 respondsTo: #size
// => true

s4 respondsTo: #includes:
// => true

s4 respondsTo: #nonExistent
// => false

// ===========================================================================
// PRINTSTRING
// ===========================================================================

((Set new) fromList: #(1, 2, 3)) printString
// => Set(1, 2, 3)

(Set new) printString
// => Set()
