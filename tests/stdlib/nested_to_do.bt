// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// BT-478: Nested to:do: with field mutations
// Tests that state is properly threaded through nested loops

// @load tests/e2e/fixtures/field_mutation_nested.bt

// Spawn actor
nested := FieldMutationNested spawn
// => _

// Test nested to:do: — 3 outer × 2 inner = 6 increments
(nested nestedIncrement: 3 inner: 2) await
// => 6

// Verify state persists
(nested getValue) await
// => 6
