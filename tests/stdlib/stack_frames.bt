// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// Stdlib tests for StackFrame introspection (BT-107)
// Tests that exceptions caught via on:do: expose stack trace information.

// stackTrace returns a list
[1 / 0] on: Exception do: [:e | e stackTrace class]
// => List

// stackTrace has entries
[1 / 0] on: Exception do: [:e | e stackTrace size > 0]
// => true

// stackTrace from does_not_understand has entries
[42 noSuchMethod] on: Exception do: [:e | e stackTrace size > 0]
// => true

// Handler without arg still works
[1 / 0] on: Exception do: [42]
// => 42

// RuntimeError also has stackTrace
[42 noSuchMethod] on: RuntimeError do: [:e | e stackTrace class]
// => List

// TypeError also has stackTrace
[#(1, 2, 3) at: "hello"] on: TypeError do: [:e | e stackTrace class]
// => List

// stackTrace first is a StackFrame
[42 noSuchMethod] on: Exception do: [:e | e stackTrace first class]
// => StackFrame

// StackFrame method returns a Symbol
[42 noSuchMethod] on: Exception do: [:e | (e stackTrace first method) class]
// => Symbol

// StackFrame arguments returns an Integer (arity)
[42 noSuchMethod] on: Exception do: [:e | (e stackTrace first arguments) class]
// => Integer

// StackFrame printString returns a String
[42 noSuchMethod] on: Exception do: [:e | (e stackTrace first printString) class]
// => String
