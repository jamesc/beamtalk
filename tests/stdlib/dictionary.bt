// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// E2E tests for Dictionary (Erlang map) methods (BT-418)

// ===========================================================================
// CREATION (BT-422)
// ===========================================================================

// Dictionary new returns an empty map
Dictionary new
// => #{}

(Dictionary new) size
// => 0

(Dictionary new) class
// => Dictionary

// Dictionary new: initializes with given entries
Dictionary new: #{#x => 10, #y => 20}
// => #{#x => 10, #y => 20}

(Dictionary new: #{#x => 10, #y => 20}) size
// => 2

(Dictionary new: #{#x => 10}) at: #x
// => 10

(Dictionary new: #{#x => 10}) class
// => Dictionary

// ===========================================================================
// CLASS
// ===========================================================================

#{#a => 1} class
// => Dictionary

#{} class
// => Dictionary

// ===========================================================================
// SIZE
// ===========================================================================

#{#a => 1, #b => 2, #c => 3} size
// => 3

#{} size
// => 0

// ===========================================================================
// KEYS & VALUES
// ===========================================================================

#{#x => 10} keys
// => ["x"]

#{#x => 10} values
// => [10]

// ===========================================================================
// AT: (lookup)
// ===========================================================================

#{#name => "Alice", #age => 30} at: #name
// => Alice

#{#x => 42} at: #x
// => 42

// ===========================================================================
// AT:PUT: (insert/update, returns new dictionary)
// ===========================================================================

d := #{#x => 1}
// => #{#x => 1}

d at: #y put: 2
// => #{#x => 1, #y => 2}

(#{#a => 1} at: #b put: 2) size
// => 2

(#{#a => 1} at: #a put: 99) at: #a
// => 99

// ===========================================================================
// AT:IFABSENT: (lookup with default)
// ===========================================================================

#{#a => 1} at: #a ifAbsent: [42]
// => 1

#{#a => 1} at: #b ifAbsent: [42]
// => 42

// ===========================================================================
// INCLUDESKEY:
// ===========================================================================

#{#a => 1, #b => 2} includesKey: #a
// => true

#{#a => 1, #b => 2} includesKey: #c
// => false

#{} includesKey: #x
// => false

// ===========================================================================
// REMOVEKEY:
// ===========================================================================

(#{#a => 1, #b => 2} removeKey: #a) size
// => 1

(#{#a => 1, #b => 2} removeKey: #a) includesKey: #a
// => false

// ===========================================================================
// MERGE:
// ===========================================================================

d1 := #{#a => 1, #b => 2}
// => #{#a => 1, #b => 2}

d2 := #{#b => 20, #c => 3}
// => #{#b => 20, #c => 3}

d1 merge: d2
// => #{#a => 1, #b => 20, #c => 3}

(#{#a => 1} merge: #{#a => 99}) at: #a
// => 99

// ===========================================================================
// KEYSANDVALUESDO:
// ===========================================================================

#{#a => 1} keysAndValuesDo: [:k :v | nil]
// => nil

// ===========================================================================
// NESTED DICTIONARIES (BT-535)
// ===========================================================================

// Nested dictionaries display correctly
#{#a => #{#x => 1}}
// => #{#a => #{#x => 1}}

// Empty nested dictionary
#{#a => #{}}
// => #{#a => #{}}
