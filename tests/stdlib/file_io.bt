// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// File I/O tests
// Migrated from E2E - sequential file operations that don't need REPL.

// ===========================================================================
// FILE EXISTENCE CHECKS
// ===========================================================================

File exists: "_bt_stdlib_nonexistent_xyzzy.txt"
// => false

// ===========================================================================
// FILE WRITING AND READING
// ===========================================================================

File writeAll: "_bt_stdlib_test.txt" contents: "Hello, Beamtalk!"
// => nil

File readAll: "_bt_stdlib_test.txt"
// => Hello, Beamtalk!

File exists: "_bt_stdlib_test.txt"
// => true

// ===========================================================================
// OVERWRITE EXISTING FILE
// ===========================================================================

File writeAll: "_bt_stdlib_test.txt" contents: "New content"
// => nil

File readAll: "_bt_stdlib_test.txt"
// => New content

// ===========================================================================
// SPECIAL CHARACTERS
// ===========================================================================

File writeAll: "_bt_stdlib_special.txt" contents: "Hello, World! @#$%"
// => nil

File readAll: "_bt_stdlib_special.txt"
// => Hello, World! @#$%

// ===========================================================================
// EMPTY FILE
// ===========================================================================

File writeAll: "_bt_stdlib_empty.txt" contents: ""
// => nil

File readAll: "_bt_stdlib_empty.txt"
// =>

File exists: "_bt_stdlib_empty.txt"
// => true

// ===========================================================================
// SECURITY: PATH VALIDATION
// ===========================================================================

File exists: "/etc/passwd"
// => false

File exists: "../passwords.txt"
// => false

// Windows-style absolute paths
File exists: "C:\\Windows\\system32"
// => false

// Backslash absolute paths
File exists: "\\\\server\\share"
// => false

// ===========================================================================
// ERROR PATHS: readAll:
// ===========================================================================

// readAll: nonexistent file
File readAll: "_bt_stdlib_no_such_file_xyz.txt"
// => ERROR: file_not_found

// readAll: non-string path
File readAll: 42
// => ERROR: type_error

// readAll: absolute path
File readAll: "/etc/passwd"
// => ERROR: invalid_path

// readAll: directory traversal
File readAll: "../secret.txt"
// => ERROR: invalid_path

// ===========================================================================
// ERROR PATHS: writeAll:contents:
// ===========================================================================

// writeAll: non-string path
File writeAll: 42 contents: "data"
// => ERROR: type_error

// writeAll: non-string contents
File writeAll: "_bt_stdlib_test.txt" contents: 42
// => ERROR: type_error

// writeAll: absolute path
File writeAll: "/tmp/evil.txt" contents: "data"
// => ERROR: invalid_path

// writeAll: directory traversal
File writeAll: "../evil.txt" contents: "data"
// => ERROR: invalid_path

// ===========================================================================
// SUBDIRECTORY CREATION
// ===========================================================================

// writeAll: creates parent directories automatically
File writeAll: "_bt_stdlib_subdir/nested.txt" contents: "nested"
// => nil

File readAll: "_bt_stdlib_subdir/nested.txt"
// => nested

// ===========================================================================
// UNICODE CONTENT
// ===========================================================================

File writeAll: "_bt_stdlib_unicode.txt" contents: "Hello 世界 🌍"
// => nil

File readAll: "_bt_stdlib_unicode.txt"
// => Hello 世界 🌍
