// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// E2E tests for value types (Object subclasses)
// Value types are plain Erlang terms with no process
// They are created with "new", not "spawn"

// @load test/fixtures/point.bt

// ===========================================================================
// VALUE TYPE INSTANTIATION
// ===========================================================================

// Create a Point with default values
Point new
// => a Point

// Create a Point with explicit values (BT-591: bare identifier map keys)
Point new: #{x => 3, y => 4}
// => a Point

// Verify bare identifier keys actually set field values
p2 := Point new: #{x => 10, y => 20}
// => a Point

p2 getX
// => 10

p2 getY
// => 20

// Mixed keys: bare identifier and explicit symbol
p3 := Point new: #{x => 5, #y => 15}
// => a Point

p3 getX
// => 5

p3 getY
// => 15

// ===========================================================================
// ACCESSING FIELDS
// ===========================================================================

// Access fields via instance methods (BT-354)
p := Point new
// => a Point

p getX
// => 0

p getY
// => 0

// ===========================================================================
// METHOD CALLS
// ===========================================================================

// Inherited Object base methods work on value types (BT-354)
p class
// => Point

// ===========================================================================
// IMMUTABILITY
// ===========================================================================

// Value types are immutable - methods return new instances
p4 := Point new: #{x => 1, y => 2}
// => a Point

p5 := p4
// => a Point

p4 == p5
// => true

// ===========================================================================
// COPYING SEMANTICS
// ===========================================================================

// Value types are copied when sent between processes
// (This is default BEAM behavior for non-process terms)

// ===========================================================================
// ACTOR INSTANTIATION ERRORS
// ===========================================================================

// Actors MUST use "spawn", not "new"
// @load test/fixtures/counter.bt
// Counter new
// // => Error: Actors must use spawn, not new
