// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// BT-838: ClassBuilder validation tests (ADR 0038)
//
// Tests ClassBuilder error cases that are path-independent: validation
// failures are caught before class registration regardless of compiled vs
// dynamic path. The dynamic closure path (Path 2) has been removed (BT-873);
// these tests exercise the validate/2 logic in beamtalk_class_builder.erl.

TestCase subclass: ClassBuilderTest
  state: cls = nil

  tearDown =>
    self.cls isNil ifFalse: [self.cls removeFromSystem]

  testSealedClassRejected =>
    self should: [(Object classBuilder name: #CBBadSeal; superclass: Float; register) await] raise: #instantiation_error

  testMissingSuperclassRejected =>
    self should: [(Object classBuilder register) await] raise: #missing_parameter
