// Copyright 2026 James Casey
// SPDX-License-Identifier: Apache-2.0

// Counter actor with methods that use field mutations in control flow
// Tests BT-98: Field assignments in nested blocks and expressions
// Currently only do: is supported; other control flow needs further fixes

Actor subclass: FieldMutationCounter
  state: value = 0

  getValue => ^self.value

  setValue: v => self.value := v

  // do: with field mutation (accumulate sum)
  sumArray: items =>
    items do: [:item | self.value := self.value + item].
    ^self.value

  // inject:into: without field mutation (pure functional)
  sumWithInject: items =>
    ^items inject: 0 into: [:sum :item | sum + item]
