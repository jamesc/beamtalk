---
source: test-package-compiler/tests/compiler_tests.rs
expression: output
---
AST:
Module {
    classes: [],
    expressions: [
        Assignment {
            target: Identifier(
                Identifier {
                    name: "x",
                    span: Span {
                        start: 224,
                        end: 225,
                    },
                },
            ),
            value: MessageSend {
                receiver: Error {
                    message: "Unexpected token: expected expression, found :=",
                    span: Span {
                        start: 229,
                        end: 231,
                    },
                },
                selector: Binary(
                    "+",
                ),
                arguments: [
                    Error {
                        message: "Unexpected token: expected expression, found :=",
                        span: Span {
                            start: 234,
                            end: 236,
                        },
                    },
                ],
                span: Span {
                    start: 229,
                    end: 236,
                },
            },
            span: Span {
                start: 224,
                end: 236,
            },
        },
        Literal(
            Integer(
                42,
            ),
            Span {
                start: 237,
                end: 239,
            },
        ),
        Assignment {
            target: Identifier(
                Identifier {
                    name: "str",
                    span: Span {
                        start: 287,
                        end: 290,
                    },
                },
            ),
            value: MessageSend {
                receiver: MessageSend {
                    receiver: MessageSend {
                        receiver: Literal(
                            String(
                                "unterminated\ny := 10\n\n// Invalid assignment with missing operand\nresult := x + + y\n\n// Multiple malformed messages in sequence\nobject at: put: get:\narray add: remove:\n\n// Nested error (malformed message inside valid structure)\nouter := (inner at: missing: broken)\n\n// Mixed errors: unterminated string + invalid syntax + malformed message\nbroken := ",
                            ),
                            Span {
                                start: 294,
                                end: 645,
                            },
                        ),
                        selector: Unary(
                            "unclosed",
                        ),
                        arguments: [],
                        span: Span {
                            start: 294,
                            end: 653,
                        },
                    },
                    selector: Binary(
                        "+",
                    ),
                    arguments: [
                        Error {
                            message: "Unexpected token: expected expression, found :=",
                            span: Span {
                                start: 656,
                                end: 658,
                            },
                        },
                    ],
                    span: Span {
                        start: 294,
                        end: 658,
                    },
                },
                selector: Keyword(
                    [
                        KeywordPart {
                            keyword: "at:",
                            span: Span {
                                start: 659,
                                end: 662,
                            },
                        },
                    ],
                ),
                arguments: [
                    Literal(
                        Integer(
                            42,
                        ),
                        Span {
                            start: 663,
                            end: 665,
                        },
                    ),
                ],
                span: Span {
                    start: 294,
                    end: 665,
                },
            },
            span: Span {
                start: 287,
                end: 665,
            },
        },
        Assignment {
            target: Identifier(
                Identifier {
                    name: "validAfterErrors",
                    span: Span {
                        start: 722,
                        end: 738,
                    },
                },
            ),
            value: MessageSend {
                receiver: Literal(
                    Integer(
                        100,
                    ),
                    Span {
                        start: 742,
                        end: 745,
                    },
                ),
                selector: Binary(
                    "+",
                ),
                arguments: [
                    Literal(
                        Integer(
                            200,
                        ),
                        Span {
                            start: 748,
                            end: 751,
                        },
                    ),
                ],
                span: Span {
                    start: 742,
                    end: 751,
                },
            },
            span: Span {
                start: 722,
                end: 751,
            },
        },
    ],
    span: Span {
        start: 224,
        end: 751,
    },
    leading_comments: [
        Comment {
            content: "// Copyright 2026 James Casey",
            span: Span {
                start: 224,
                end: 225,
            },
            kind: Line,
        },
        Comment {
            content: "// SPDX-License-Identifier: Apache-2.0",
            span: Span {
                start: 224,
                end: 225,
            },
            kind: Line,
        },
        Comment {
            content: "// Test boundary condition: mixed error scenarios",
            span: Span {
                start: 224,
                end: 225,
            },
            kind: Line,
        },
        Comment {
            content: "// Multiple errors in single expressions and compound statements",
            span: Span {
                start: 224,
                end: 225,
            },
            kind: Line,
        },
        Comment {
            content: "// Multiple syntax errors in one line",
            span: Span {
                start: 224,
                end: 225,
            },
            kind: Line,
        },
    ],
}

Diagnostics:
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found :=", span: Span { start: 229, end: 231 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found :=", span: Span { start: 234, end: 236 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found :=", span: Span { start: 656, end: 658 }, hint: None }
