---
source: test-package-compiler/tests/compiler_tests.rs
expression: output
---
AST:
Module {
    classes: [],
    method_definitions: [],
    expressions: [
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Copyright 2026 James Casey",
                        span: Span {
                            start: 164,
                            end: 168,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "SPDX-License-Identifier: Apache-2.0",
                        span: Span {
                            start: 164,
                            end: 168,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "Test string interpolation compilation (ADR 0023 Phase 3)",
                        span: Span {
                            start: 164,
                            end: 168,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                    Comment {
                        content: "Simple variable interpolation",
                        span: Span {
                            start: 164,
                            end: 168,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "name",
                        span: Span {
                            start: 164,
                            end: 168,
                        },
                    },
                ),
                value: Literal(
                    String(
                        "Alice",
                    ),
                    Span {
                        start: 172,
                        end: 179,
                    },
                ),
                span: Span {
                    start: 164,
                    end: 179,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "greeting",
                        span: Span {
                            start: 180,
                            end: 188,
                        },
                    },
                ),
                value: StringInterpolation {
                    segments: [
                        Literal(
                            "Hello, ",
                        ),
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "name",
                                    span: Span {
                                        start: 201,
                                        end: 205,
                                    },
                                },
                            ),
                        ),
                        Literal(
                            "!",
                        ),
                    ],
                    span: Span {
                        start: 192,
                        end: 208,
                    },
                },
                span: Span {
                    start: 180,
                    end: 208,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Expression interpolation",
                        span: Span {
                            start: 238,
                            end: 241,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "age",
                        span: Span {
                            start: 238,
                            end: 241,
                        },
                    },
                ),
                value: Literal(
                    Integer(
                        25,
                    ),
                    Span {
                        start: 245,
                        end: 247,
                    },
                ),
                span: Span {
                    start: 238,
                    end: 247,
                },
            },
            preceding_blank_line: true,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "message",
                        span: Span {
                            start: 248,
                            end: 255,
                        },
                    },
                ),
                value: StringInterpolation {
                    segments: [
                        Literal(
                            "You are ",
                        ),
                        Interpolation(
                            MessageSend {
                                receiver: Identifier(
                                    Identifier {
                                        name: "age",
                                        span: Span {
                                            start: 269,
                                            end: 272,
                                        },
                                    },
                                ),
                                selector: Binary(
                                    "+",
                                ),
                                arguments: [
                                    Literal(
                                        Integer(
                                            5,
                                        ),
                                        Span {
                                            start: 275,
                                            end: 276,
                                        },
                                    ),
                                ],
                                is_cast: false,
                                span: Span {
                                    start: 269,
                                    end: 276,
                                },
                            },
                        ),
                        Literal(
                            " years old in 5 years",
                        ),
                    ],
                    span: Span {
                        start: 259,
                        end: 299,
                    },
                },
                span: Span {
                    start: 248,
                    end: 299,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Multiple interpolations in one string",
                        span: Span {
                            start: 342,
                            end: 351,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "firstName",
                        span: Span {
                            start: 342,
                            end: 351,
                        },
                    },
                ),
                value: Literal(
                    String(
                        "Bob",
                    ),
                    Span {
                        start: 355,
                        end: 360,
                    },
                ),
                span: Span {
                    start: 342,
                    end: 360,
                },
            },
            preceding_blank_line: true,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "lastName",
                        span: Span {
                            start: 361,
                            end: 369,
                        },
                    },
                ),
                value: Literal(
                    String(
                        "Smith",
                    ),
                    Span {
                        start: 373,
                        end: 380,
                    },
                ),
                span: Span {
                    start: 361,
                    end: 380,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "fullName",
                        span: Span {
                            start: 381,
                            end: 389,
                        },
                    },
                ),
                value: StringInterpolation {
                    segments: [
                        Literal(
                            "Name: ",
                        ),
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "firstName",
                                    span: Span {
                                        start: 401,
                                        end: 410,
                                    },
                                },
                            ),
                        ),
                        Literal(
                            " ",
                        ),
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "lastName",
                                    span: Span {
                                        start: 413,
                                        end: 421,
                                    },
                                },
                            ),
                        ),
                    ],
                    span: Span {
                        start: 393,
                        end: 423,
                    },
                },
                span: Span {
                    start: 381,
                    end: 423,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Escape sequences in interpolated strings",
                        span: Span {
                            start: 469,
                            end: 476,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "escaped",
                        span: Span {
                            start: 469,
                            end: 476,
                        },
                    },
                ),
                value: StringInterpolation {
                    segments: [
                        Literal(
                            "Literal braces: \\{ and \\}, variable: ",
                        ),
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "name",
                                    span: Span {
                                        start: 519,
                                        end: 523,
                                    },
                                },
                            ),
                        ),
                    ],
                    span: Span {
                        start: 480,
                        end: 525,
                    },
                },
                span: Span {
                    start: 469,
                    end: 525,
                },
            },
            preceding_blank_line: true,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Unicode in interpolated strings",
                        span: Span {
                            start: 562,
                            end: 570,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "emojiVar",
                        span: Span {
                            start: 562,
                            end: 570,
                        },
                    },
                ),
                value: Literal(
                    String(
                        "ðŸŽ‰",
                    ),
                    Span {
                        start: 574,
                        end: 580,
                    },
                ),
                span: Span {
                    start: 562,
                    end: 580,
                },
            },
            preceding_blank_line: true,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "withEmoji",
                        span: Span {
                            start: 581,
                            end: 590,
                        },
                    },
                ),
                value: StringInterpolation {
                    segments: [
                        Literal(
                            "Celebration: ",
                        ),
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "emojiVar",
                                    span: Span {
                                        start: 609,
                                        end: 617,
                                    },
                                },
                            ),
                        ),
                        Literal(
                            " ",
                        ),
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "name",
                                    span: Span {
                                        start: 620,
                                        end: 624,
                                    },
                                },
                            ),
                        ),
                        Literal(
                            "!",
                        ),
                    ],
                    span: Span {
                        start: 594,
                        end: 627,
                    },
                },
                span: Span {
                    start: 581,
                    end: 627,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Integer printString conversion",
                        span: Span {
                            start: 663,
                            end: 668,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "count",
                        span: Span {
                            start: 663,
                            end: 668,
                        },
                    },
                ),
                value: Literal(
                    Integer(
                        10,
                    ),
                    Span {
                        start: 672,
                        end: 674,
                    },
                ),
                span: Span {
                    start: 663,
                    end: 674,
                },
            },
            preceding_blank_line: true,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "summary",
                        span: Span {
                            start: 675,
                            end: 682,
                        },
                    },
                ),
                value: StringInterpolation {
                    segments: [
                        Literal(
                            "Total: ",
                        ),
                        Interpolation(
                            MessageSend {
                                receiver: Identifier(
                                    Identifier {
                                        name: "count",
                                        span: Span {
                                            start: 695,
                                            end: 700,
                                        },
                                    },
                                ),
                                selector: Binary(
                                    "*",
                                ),
                                arguments: [
                                    Literal(
                                        Integer(
                                            2,
                                        ),
                                        Span {
                                            start: 703,
                                            end: 704,
                                        },
                                    ),
                                ],
                                is_cast: false,
                                span: Span {
                                    start: 695,
                                    end: 704,
                                },
                            },
                        ),
                    ],
                    span: Span {
                        start: 686,
                        end: 706,
                    },
                },
                span: Span {
                    start: 675,
                    end: 706,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Adjacent interpolations",
                        span: Span {
                            start: 735,
                            end: 743,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "adjacent",
                        span: Span {
                            start: 735,
                            end: 743,
                        },
                    },
                ),
                value: StringInterpolation {
                    segments: [
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "firstName",
                                    span: Span {
                                        start: 749,
                                        end: 758,
                                    },
                                },
                            ),
                        ),
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "lastName",
                                    span: Span {
                                        start: 760,
                                        end: 768,
                                    },
                                },
                            ),
                        ),
                    ],
                    span: Span {
                        start: 747,
                        end: 770,
                    },
                },
                span: Span {
                    start: 735,
                    end: 770,
                },
            },
            preceding_blank_line: true,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Only interpolation (no literal segments)",
                        span: Span {
                            start: 816,
                            end: 820,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "bare",
                        span: Span {
                            start: 816,
                            end: 820,
                        },
                    },
                ),
                value: StringInterpolation {
                    segments: [
                        Interpolation(
                            Identifier(
                                Identifier {
                                    name: "name",
                                    span: Span {
                                        start: 826,
                                        end: 830,
                                    },
                                },
                            ),
                        ),
                    ],
                    span: Span {
                        start: 824,
                        end: 832,
                    },
                },
                span: Span {
                    start: 816,
                    end: 832,
                },
            },
            preceding_blank_line: true,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Plain string (no interpolation, zero overhead)",
                        span: Span {
                            start: 884,
                            end: 889,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "plain",
                        span: Span {
                            start: 884,
                            end: 889,
                        },
                    },
                ),
                value: Literal(
                    String(
                        "Hello, World!",
                    ),
                    Span {
                        start: 893,
                        end: 908,
                    },
                ),
                span: Span {
                    start: 884,
                    end: 908,
                },
            },
            preceding_blank_line: true,
        },
    ],
    span: Span {
        start: 164,
        end: 908,
    },
    file_leading_comments: [],
    file_trailing_comments: [],
}
