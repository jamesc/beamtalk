---
source: test-package-compiler/tests/compiler_tests.rs
expression: output
---
AST:
Module {
    classes: [],
    expressions: [
        Assignment {
            target: Identifier(
                Identifier {
                    name: "result1",
                    span: Span {
                        start: 243,
                        end: 250,
                    },
                },
            ),
            value: Parenthesized {
                expression: Parenthesized {
                    expression: Parenthesized {
                        expression: Parenthesized {
                            expression: Parenthesized {
                                expression: Parenthesized {
                                    expression: Parenthesized {
                                        expression: Parenthesized {
                                            expression: Parenthesized {
                                                expression: Parenthesized {
                                                    expression: MessageSend {
                                                        receiver: Literal(
                                                            Integer(
                                                                1,
                                                            ),
                                                            Span {
                                                                start: 264,
                                                                end: 265,
                                                            },
                                                        ),
                                                        selector: Binary(
                                                            "+",
                                                        ),
                                                        arguments: [
                                                            Literal(
                                                                Integer(
                                                                    2,
                                                                ),
                                                                Span {
                                                                    start: 268,
                                                                    end: 269,
                                                                },
                                                            ),
                                                        ],
                                                        span: Span {
                                                            start: 264,
                                                            end: 269,
                                                        },
                                                    },
                                                    span: Span {
                                                        start: 263,
                                                        end: 270,
                                                    },
                                                },
                                                span: Span {
                                                    start: 262,
                                                    end: 271,
                                                },
                                            },
                                            span: Span {
                                                start: 261,
                                                end: 272,
                                            },
                                        },
                                        span: Span {
                                            start: 260,
                                            end: 273,
                                        },
                                    },
                                    span: Span {
                                        start: 259,
                                        end: 274,
                                    },
                                },
                                span: Span {
                                    start: 258,
                                    end: 275,
                                },
                            },
                            span: Span {
                                start: 257,
                                end: 276,
                            },
                        },
                        span: Span {
                            start: 256,
                            end: 277,
                        },
                    },
                    span: Span {
                        start: 255,
                        end: 278,
                    },
                },
                span: Span {
                    start: 254,
                    end: 279,
                },
            },
            span: Span {
                start: 243,
                end: 279,
            },
        },
        Assignment {
            target: Identifier(
                Identifier {
                    name: "result2",
                    span: Span {
                        start: 323,
                        end: 330,
                    },
                },
            ),
            value: MessageSend {
                receiver: MessageSend {
                    receiver: MessageSend {
                        receiver: MessageSend {
                            receiver: MessageSend {
                                receiver: MessageSend {
                                    receiver: MessageSend {
                                        receiver: MessageSend {
                                            receiver: Identifier(
                                                Identifier {
                                                    name: "object",
                                                    span: Span {
                                                        start: 334,
                                                        end: 340,
                                                    },
                                                },
                                            ),
                                            selector: Unary(
                                                "method1",
                                            ),
                                            arguments: [],
                                            span: Span {
                                                start: 334,
                                                end: 348,
                                            },
                                        },
                                        selector: Unary(
                                            "method2",
                                        ),
                                        arguments: [],
                                        span: Span {
                                            start: 334,
                                            end: 356,
                                        },
                                    },
                                    selector: Unary(
                                        "method3",
                                    ),
                                    arguments: [],
                                    span: Span {
                                        start: 334,
                                        end: 364,
                                    },
                                },
                                selector: Unary(
                                    "method4",
                                ),
                                arguments: [],
                                span: Span {
                                    start: 334,
                                    end: 372,
                                },
                            },
                            selector: Unary(
                                "method5",
                            ),
                            arguments: [],
                            span: Span {
                                start: 334,
                                end: 380,
                            },
                        },
                        selector: Unary(
                            "method6",
                        ),
                        arguments: [],
                        span: Span {
                            start: 334,
                            end: 388,
                        },
                    },
                    selector: Unary(
                        "method7",
                    ),
                    arguments: [],
                    span: Span {
                        start: 334,
                        end: 396,
                    },
                },
                selector: Unary(
                    "method8",
                ),
                arguments: [],
                span: Span {
                    start: 334,
                    end: 404,
                },
            },
            span: Span {
                start: 323,
                end: 404,
            },
        },
        Assignment {
            target: Identifier(
                Identifier {
                    name: "result3",
                    span: Span {
                        start: 451,
                        end: 458,
                    },
                },
            ),
            value: MessageSend {
                receiver: Identifier(
                    Identifier {
                        name: "object",
                        span: Span {
                            start: 462,
                            end: 468,
                        },
                    },
                ),
                selector: Keyword(
                    [
                        KeywordPart {
                            keyword: "at:",
                            span: Span {
                                start: 469,
                                end: 472,
                            },
                        },
                    ],
                ),
                arguments: [
                    Parenthesized {
                        expression: MessageSend {
                            receiver: Identifier(
                                Identifier {
                                    name: "dict",
                                    span: Span {
                                        start: 474,
                                        end: 478,
                                    },
                                },
                            ),
                            selector: Keyword(
                                [
                                    KeywordPart {
                                        keyword: "at:",
                                        span: Span {
                                            start: 479,
                                            end: 482,
                                        },
                                    },
                                ],
                            ),
                            arguments: [
                                Parenthesized {
                                    expression: MessageSend {
                                        receiver: Identifier(
                                            Identifier {
                                                name: "array",
                                                span: Span {
                                                    start: 484,
                                                    end: 489,
                                                },
                                            },
                                        ),
                                        selector: Keyword(
                                            [
                                                KeywordPart {
                                                    keyword: "at:",
                                                    span: Span {
                                                        start: 490,
                                                        end: 493,
                                                    },
                                                },
                                            ],
                                        ),
                                        arguments: [
                                            Parenthesized {
                                                expression: MessageSend {
                                                    receiver: Identifier(
                                                        Identifier {
                                                            name: "list",
                                                            span: Span {
                                                                start: 495,
                                                                end: 499,
                                                            },
                                                        },
                                                    ),
                                                    selector: Keyword(
                                                        [
                                                            KeywordPart {
                                                                keyword: "at:",
                                                                span: Span {
                                                                    start: 500,
                                                                    end: 503,
                                                                },
                                                            },
                                                        ],
                                                    ),
                                                    arguments: [
                                                        Parenthesized {
                                                            expression: MessageSend {
                                                                receiver: Identifier(
                                                                    Identifier {
                                                                        name: "map",
                                                                        span: Span {
                                                                            start: 505,
                                                                            end: 508,
                                                                        },
                                                                    },
                                                                ),
                                                                selector: Keyword(
                                                                    [
                                                                        KeywordPart {
                                                                            keyword: "at:",
                                                                            span: Span {
                                                                                start: 509,
                                                                                end: 512,
                                                                            },
                                                                        },
                                                                    ],
                                                                ),
                                                                arguments: [
                                                                    Literal(
                                                                        String(
                                                                            "key",
                                                                        ),
                                                                        Span {
                                                                            start: 513,
                                                                            end: 518,
                                                                        },
                                                                    ),
                                                                ],
                                                                span: Span {
                                                                    start: 505,
                                                                    end: 518,
                                                                },
                                                            },
                                                            span: Span {
                                                                start: 504,
                                                                end: 519,
                                                            },
                                                        },
                                                    ],
                                                    span: Span {
                                                        start: 495,
                                                        end: 519,
                                                    },
                                                },
                                                span: Span {
                                                    start: 494,
                                                    end: 520,
                                                },
                                            },
                                        ],
                                        span: Span {
                                            start: 484,
                                            end: 520,
                                        },
                                    },
                                    span: Span {
                                        start: 483,
                                        end: 521,
                                    },
                                },
                            ],
                            span: Span {
                                start: 474,
                                end: 521,
                            },
                        },
                        span: Span {
                            start: 473,
                            end: 522,
                        },
                    },
                ],
                span: Span {
                    start: 462,
                    end: 522,
                },
            },
            span: Span {
                start: 451,
                end: 522,
            },
        },
        Assignment {
            target: Identifier(
                Identifier {
                    name: "result4",
                    span: Span {
                        start: 559,
                        end: 566,
                    },
                },
            ),
            value: Block(
                Block {
                    parameters: [],
                    body: [
                        Block(
                            Block {
                                parameters: [],
                                body: [
                                    Block(
                                        Block {
                                            parameters: [],
                                            body: [
                                                Block(
                                                    Block {
                                                        parameters: [],
                                                        body: [
                                                            Block(
                                                                Block {
                                                                    parameters: [],
                                                                    body: [
                                                                        Block(
                                                                            Block {
                                                                                parameters: [],
                                                                                body: [
                                                                                    Literal(
                                                                                        Integer(
                                                                                            42,
                                                                                        ),
                                                                                        Span {
                                                                                            start: 576,
                                                                                            end: 578,
                                                                                        },
                                                                                    ),
                                                                                ],
                                                                                span: Span {
                                                                                    start: 575,
                                                                                    end: 579,
                                                                                },
                                                                            },
                                                                        ),
                                                                    ],
                                                                    span: Span {
                                                                        start: 574,
                                                                        end: 580,
                                                                    },
                                                                },
                                                            ),
                                                        ],
                                                        span: Span {
                                                            start: 573,
                                                            end: 581,
                                                        },
                                                    },
                                                ),
                                            ],
                                            span: Span {
                                                start: 572,
                                                end: 582,
                                            },
                                        },
                                    ),
                                ],
                                span: Span {
                                    start: 571,
                                    end: 583,
                                },
                            },
                        ),
                    ],
                    span: Span {
                        start: 570,
                        end: 584,
                    },
                },
            ),
            span: Span {
                start: 559,
                end: 584,
            },
        },
        Assignment {
            target: Identifier(
                Identifier {
                    name: "result5",
                    span: Span {
                        start: 643,
                        end: 650,
                    },
                },
            ),
            value: Block(
                Block {
                    parameters: [],
                    body: [
                        Block(
                            Block {
                                parameters: [
                                    BlockParameter {
                                        name: "x",
                                        span: Span {
                                            start: 657,
                                            end: 658,
                                        },
                                    },
                                ],
                                body: [
                                    Block(
                                        Block {
                                            parameters: [],
                                            body: [
                                                Block(
                                                    Block {
                                                        parameters: [
                                                            BlockParameter {
                                                                name: "y",
                                                                span: Span {
                                                                    start: 664,
                                                                    end: 665,
                                                                },
                                                            },
                                                        ],
                                                        body: [
                                                            Block(
                                                                Block {
                                                                    parameters: [],
                                                                    body: [
                                                                        Block(
                                                                            Block {
                                                                                parameters: [
                                                                                    BlockParameter {
                                                                                        name: "z",
                                                                                        span: Span {
                                                                                            start: 671,
                                                                                            end: 672,
                                                                                        },
                                                                                    },
                                                                                ],
                                                                                body: [
                                                                                    MessageSend {
                                                                                        receiver: Identifier(
                                                                                            Identifier {
                                                                                                name: "x",
                                                                                                span: Span {
                                                                                                    start: 675,
                                                                                                    end: 676,
                                                                                                },
                                                                                            },
                                                                                        ),
                                                                                        selector: Binary(
                                                                                            "+",
                                                                                        ),
                                                                                        arguments: [
                                                                                            MessageSend {
                                                                                                receiver: Identifier(
                                                                                                    Identifier {
                                                                                                        name: "y",
                                                                                                        span: Span {
                                                                                                            start: 679,
                                                                                                            end: 680,
                                                                                                        },
                                                                                                    },
                                                                                                ),
                                                                                                selector: Binary(
                                                                                                    "*",
                                                                                                ),
                                                                                                arguments: [
                                                                                                    Identifier(
                                                                                                        Identifier {
                                                                                                            name: "z",
                                                                                                            span: Span {
                                                                                                                start: 683,
                                                                                                                end: 684,
                                                                                                            },
                                                                                                        },
                                                                                                    ),
                                                                                                ],
                                                                                                span: Span {
                                                                                                    start: 679,
                                                                                                    end: 684,
                                                                                                },
                                                                                            },
                                                                                        ],
                                                                                        span: Span {
                                                                                            start: 675,
                                                                                            end: 684,
                                                                                        },
                                                                                    },
                                                                                ],
                                                                                span: Span {
                                                                                    start: 669,
                                                                                    end: 685,
                                                                                },
                                                                            },
                                                                        ),
                                                                    ],
                                                                    span: Span {
                                                                        start: 668,
                                                                        end: 686,
                                                                    },
                                                                },
                                                            ),
                                                        ],
                                                        span: Span {
                                                            start: 662,
                                                            end: 687,
                                                        },
                                                    },
                                                ),
                                            ],
                                            span: Span {
                                                start: 661,
                                                end: 688,
                                            },
                                        },
                                    ),
                                ],
                                span: Span {
                                    start: 655,
                                    end: 689,
                                },
                            },
                        ),
                    ],
                    span: Span {
                        start: 654,
                        end: 655,
                    },
                },
            ),
            span: Span {
                start: 643,
                end: 655,
            },
        },
        Assignment {
            target: Identifier(
                Identifier {
                    name: "result6",
                    span: Span {
                        start: 732,
                        end: 739,
                    },
                },
            ),
            value: Parenthesized {
                expression: Identifier(
                    Identifier {
                        name: "object",
                        span: Span {
                            start: 744,
                            end: 750,
                        },
                    },
                ),
                span: Span {
                    start: 743,
                    end: 744,
                },
            },
            span: Span {
                start: 732,
                end: 744,
            },
        },
        Error {
            message: "Unexpected token: expected expression, found at:",
            span: Span {
                start: 755,
                end: 758,
            },
        },
        Error {
            message: "Unexpected token: expected expression, found )",
            span: Span {
                start: 774,
                end: 775,
            },
        },
        Error {
            message: "Unexpected token: expected expression, found )",
            span: Span {
                start: 799,
                end: 800,
            },
        },
        Error {
            message: "Unexpected token: expected expression, found ;",
            span: Span {
                start: 801,
                end: 802,
            },
        },
        Error {
            message: "Unexpected token: expected expression, found )",
            span: Span {
                start: 826,
                end: 827,
            },
        },
        Error {
            message: "Unexpected token: expected expression, found )",
            span: Span {
                start: 851,
                end: 852,
            },
        },
        Error {
            message: "Unexpected token: expected expression, found )",
            span: Span {
                start: 853,
                end: 854,
            },
        },
    ],
    span: Span {
        start: 243,
        end: 854,
    },
    leading_comments: [
        Comment {
            content: "// Copyright 2026 James Casey",
            span: Span {
                start: 243,
                end: 250,
            },
            kind: Line,
        },
        Comment {
            content: "// SPDX-License-Identifier: Apache-2.0",
            span: Span {
                start: 243,
                end: 250,
            },
            kind: Line,
        },
        Comment {
            content: "// Test boundary condition: deeply nested expressions",
            span: Span {
                start: 243,
                end: 250,
            },
            kind: Line,
        },
        Comment {
            content: "// Stress test parser stack depth with multiple nesting levels",
            span: Span {
                start: 243,
                end: 250,
            },
            kind: Line,
        },
        Comment {
            content: "// Deeply nested parenthesized expressions (10 levels)",
            span: Span {
                start: 243,
                end: 250,
            },
            kind: Line,
        },
    ],
}

Diagnostics:
Diagnostic { severity: Error, message: "Expected ']' to close block", span: Span { start: 732, end: 739 }, hint: None }
Diagnostic { severity: Error, message: "Expected ')' to close parentheses", span: Span { start: 755, end: 758 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found at:", span: Span { start: 755, end: 758 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 774, end: 775 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 799, end: 800 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ;", span: Span { start: 801, end: 802 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 826, end: 827 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 851, end: 852 }, hint: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 853, end: 854 }, hint: None }
