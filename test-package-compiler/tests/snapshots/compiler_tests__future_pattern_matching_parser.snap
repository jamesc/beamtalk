---
source: test-package-compiler/tests/compiler_tests.rs
expression: output
---
AST:
Module {
    classes: [],
    method_definitions: [],
    expressions: [
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Copyright 2026 James Casey",
                        span: Span {
                            start: 268,
                            end: 274,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "SPDX-License-Identifier: Apache-2.0",
                        span: Span {
                            start: 268,
                            end: 274,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "Test future feature: pattern matching",
                        span: Span {
                            start: 268,
                            end: 274,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                    Comment {
                        content: "Match expressions with destructuring and guards",
                        span: Span {
                            start: 268,
                            end: 274,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "NOTE: This feature is not yet implemented - test documents expected behavior",
                        span: Span {
                            start: 268,
                            end: 274,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "Simple value matching",
                        span: Span {
                            start: 268,
                            end: 274,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                ],
                trailing: None,
            },
            expression: Assignment {
                target: Identifier(
                    Identifier {
                        name: "result",
                        span: Span {
                            start: 268,
                            end: 274,
                        },
                    },
                ),
                value: MessageSend {
                    receiver: MessageSend {
                        receiver: Identifier(
                            Identifier {
                                name: "match",
                                span: Span {
                                    start: 278,
                                    end: 283,
                                },
                            },
                        ),
                        selector: Unary(
                            "value",
                        ),
                        arguments: [],
                        is_cast: false,
                        span: Span {
                            start: 278,
                            end: 289,
                        },
                    },
                    selector: Unary(
                        "with",
                    ),
                    arguments: [],
                    is_cast: false,
                    span: Span {
                        start: 278,
                        end: 294,
                    },
                },
                span: Span {
                    start: 268,
                    end: 294,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found |",
                span: Span {
                    start: 297,
                    end: 298,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found ]",
                span: Span {
                    start: 558,
                    end: 559,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found ]",
                span: Span {
                    start: 581,
                    end: 582,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found ]",
                span: Span {
                    start: 614,
                    end: 615,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found ]",
                span: Span {
                    start: 647,
                    end: 648,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found }",
                span: Span {
                    start: 767,
                    end: 768,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found }",
                span: Span {
                    start: 819,
                    end: 820,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found }",
                span: Span {
                    start: 866,
                    end: 867,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: MessageSend {
                receiver: MessageSend {
                    receiver: MessageSend {
                        receiver: Error {
                            message: "Unexpected token: expected expression, found )",
                            span: Span {
                                start: 993,
                                end: 994,
                            },
                        },
                        selector: Unary(
                            "when",
                        ),
                        arguments: [],
                        is_cast: false,
                        span: Span {
                            start: 993,
                            end: 999,
                        },
                    },
                    selector: Unary(
                        "r",
                    ),
                    arguments: [],
                    is_cast: false,
                    span: Span {
                        start: 993,
                        end: 1001,
                    },
                },
                selector: Binary(
                    ">",
                ),
                arguments: [
                    Literal(
                        Integer(
                            10,
                        ),
                        Span {
                            start: 1004,
                            end: 1006,
                        },
                    ),
                ],
                is_cast: false,
                span: Span {
                    start: 993,
                    end: 1006,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found =>",
                span: Span {
                    start: 1007,
                    end: 1009,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found )",
                span: Span {
                    start: 1045,
                    end: 1046,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found )",
                span: Span {
                    start: 1102,
                    end: 1103,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found )",
                span: Span {
                    start: 1247,
                    end: 1248,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found )",
                span: Span {
                    start: 1282,
                    end: 1283,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found )",
                span: Span {
                    start: 1319,
                    end: 1320,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found }",
                span: Span {
                    start: 1476,
                    end: 1477,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found }",
                span: Span {
                    start: 1514,
                    end: 1515,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found ]",
                span: Span {
                    start: 1683,
                    end: 1684,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found ]",
                span: Span {
                    start: 1907,
                    end: 1908,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: MessageSend {
                receiver: MessageSend {
                    receiver: MessageSend {
                        receiver: Error {
                            message: "Unexpected token: expected expression, found }",
                            span: Span {
                                start: 1919,
                                end: 1920,
                            },
                        },
                        selector: Unary(
                            "when",
                        ),
                        arguments: [],
                        is_cast: false,
                        span: Span {
                            start: 1919,
                            end: 1925,
                        },
                    },
                    selector: Unary(
                        "n",
                    ),
                    arguments: [],
                    is_cast: false,
                    span: Span {
                        start: 1919,
                        end: 1927,
                    },
                },
                selector: Binary(
                    ">",
                ),
                arguments: [
                    Literal(
                        Integer(
                            2,
                        ),
                        Span {
                            start: 1930,
                            end: 1931,
                        },
                    ),
                ],
                is_cast: false,
                span: Span {
                    start: 1919,
                    end: 1931,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found =>",
                span: Span {
                    start: 1932,
                    end: 1934,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found ]",
                span: Span {
                    start: 2021,
                    end: 2022,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found }",
                span: Span {
                    start: 2033,
                    end: 2034,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found ]",
                span: Span {
                    start: 2081,
                    end: 2082,
                },
            },
            preceding_blank_line: false,
        },
        ExpressionStatement {
            comments: CommentAttachment {
                leading: [],
                trailing: None,
            },
            expression: Error {
                message: "Unexpected token: expected expression, found }",
                span: Span {
                    start: 2093,
                    end: 2094,
                },
            },
            preceding_blank_line: false,
        },
    ],
    span: Span {
        start: 268,
        end: 2150,
    },
    file_leading_comments: [],
    file_trailing_comments: [],
}

Diagnostics:
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found |", span: Span { start: 297, end: 298 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ]", span: Span { start: 558, end: 559 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ]", span: Span { start: 581, end: 582 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ]", span: Span { start: 614, end: 615 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ]", span: Span { start: 647, end: 648 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found }", span: Span { start: 767, end: 768 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found }", span: Span { start: 819, end: 820 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found }", span: Span { start: 866, end: 867 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 993, end: 994 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found =>", span: Span { start: 1007, end: 1009 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 1045, end: 1046 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 1102, end: 1103 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 1247, end: 1248 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 1282, end: 1283 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found )", span: Span { start: 1319, end: 1320 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found }", span: Span { start: 1476, end: 1477 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found }", span: Span { start: 1514, end: 1515 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ]", span: Span { start: 1683, end: 1684 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ]", span: Span { start: 1907, end: 1908 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found }", span: Span { start: 1919, end: 1920 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found =>", span: Span { start: 1932, end: 1934 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ]", span: Span { start: 2021, end: 2022 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found }", span: Span { start: 2033, end: 2034 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found ]", span: Span { start: 2081, end: 2082 }, hint: None, category: None }
Diagnostic { severity: Error, message: "Unexpected token: expected expression, found }", span: Span { start: 2093, end: 2094 }, hint: None, category: None }
