---
source: test-package-compiler/tests/compiler_tests.rs
expression: output
---
AST:
Module {
    classes: [
        ClassDefinition {
            name: Identifier {
                name: "Dictionary",
                span: Span {
                    start: 271,
                    end: 281,
                },
            },
            superclass: Some(
                Identifier {
                    name: "Object",
                    span: Span {
                        start: 254,
                        end: 260,
                    },
                },
            ),
            class_kind: Object,
            is_abstract: false,
            is_sealed: true,
            is_typed: false,
            state: [],
            methods: [
                MethodDefinition {
                    selector: Unary(
                        "size",
                    ),
                    parameters: [],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "size",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 305,
                                    end: 322,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [
                            Comment {
                                content: "Access",
                                span: Span {
                                    start: 297,
                                    end: 301,
                                },
                                kind: Line,
                                preceding_blank_line: true,
                            },
                        ],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 297,
                        end: 322,
                    },
                },
                MethodDefinition {
                    selector: Unary(
                        "keys",
                    ),
                    parameters: [],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "keys",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 333,
                                    end: 350,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 325,
                        end: 350,
                    },
                },
                MethodDefinition {
                    selector: Unary(
                        "values",
                    ),
                    parameters: [],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "values",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 363,
                                    end: 382,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 353,
                        end: 382,
                    },
                },
                MethodDefinition {
                    selector: Keyword(
                        [
                            KeywordPart {
                                keyword: "at:",
                                span: Span {
                                    start: 385,
                                    end: 388,
                                },
                            },
                        ],
                    ),
                    parameters: [
                        ParameterDefinition {
                            name: Identifier {
                                name: "key",
                                span: Span {
                                    start: 389,
                                    end: 392,
                                },
                            },
                            type_annotation: None,
                        },
                    ],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "at:",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 396,
                                    end: 412,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 385,
                        end: 412,
                    },
                },
                MethodDefinition {
                    selector: Keyword(
                        [
                            KeywordPart {
                                keyword: "at:",
                                span: Span {
                                    start: 415,
                                    end: 418,
                                },
                            },
                            KeywordPart {
                                keyword: "ifAbsent:",
                                span: Span {
                                    start: 423,
                                    end: 432,
                                },
                            },
                        ],
                    ),
                    parameters: [
                        ParameterDefinition {
                            name: Identifier {
                                name: "key",
                                span: Span {
                                    start: 419,
                                    end: 422,
                                },
                            },
                            type_annotation: None,
                        },
                        ParameterDefinition {
                            name: Identifier {
                                name: "block",
                                span: Span {
                                    start: 433,
                                    end: 438,
                                },
                            },
                            type_annotation: None,
                        },
                    ],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "at:ifAbsent:",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 442,
                                    end: 467,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 415,
                        end: 467,
                    },
                },
                MethodDefinition {
                    selector: Keyword(
                        [
                            KeywordPart {
                                keyword: "at:",
                                span: Span {
                                    start: 470,
                                    end: 473,
                                },
                            },
                            KeywordPart {
                                keyword: "put:",
                                span: Span {
                                    start: 478,
                                    end: 482,
                                },
                            },
                        ],
                    ),
                    parameters: [
                        ParameterDefinition {
                            name: Identifier {
                                name: "key",
                                span: Span {
                                    start: 474,
                                    end: 477,
                                },
                            },
                            type_annotation: None,
                        },
                        ParameterDefinition {
                            name: Identifier {
                                name: "value",
                                span: Span {
                                    start: 483,
                                    end: 488,
                                },
                            },
                            type_annotation: None,
                        },
                    ],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "at:put:",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 492,
                                    end: 512,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 470,
                        end: 512,
                    },
                },
                MethodDefinition {
                    selector: Keyword(
                        [
                            KeywordPart {
                                keyword: "includesKey:",
                                span: Span {
                                    start: 515,
                                    end: 527,
                                },
                            },
                        ],
                    ),
                    parameters: [
                        ParameterDefinition {
                            name: Identifier {
                                name: "key",
                                span: Span {
                                    start: 528,
                                    end: 531,
                                },
                            },
                            type_annotation: None,
                        },
                    ],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "includesKey:",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 535,
                                    end: 560,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 515,
                        end: 560,
                    },
                },
                MethodDefinition {
                    selector: Keyword(
                        [
                            KeywordPart {
                                keyword: "removeKey:",
                                span: Span {
                                    start: 603,
                                    end: 613,
                                },
                            },
                        ],
                    ),
                    parameters: [
                        ParameterDefinition {
                            name: Identifier {
                                name: "key",
                                span: Span {
                                    start: 614,
                                    end: 617,
                                },
                            },
                            type_annotation: None,
                        },
                    ],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "removeKey:",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 621,
                                    end: 644,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [
                            Comment {
                                content: "Mutation (returns new dictionary)",
                                span: Span {
                                    start: 603,
                                    end: 613,
                                },
                                kind: Line,
                                preceding_blank_line: true,
                            },
                        ],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 603,
                        end: 644,
                    },
                },
                MethodDefinition {
                    selector: Keyword(
                        [
                            KeywordPart {
                                keyword: "merge:",
                                span: Span {
                                    start: 647,
                                    end: 653,
                                },
                            },
                        ],
                    ),
                    parameters: [
                        ParameterDefinition {
                            name: Identifier {
                                name: "other",
                                span: Span {
                                    start: 654,
                                    end: 659,
                                },
                            },
                            type_annotation: None,
                        },
                    ],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "merge:",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 663,
                                    end: 682,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 647,
                        end: 682,
                    },
                },
                MethodDefinition {
                    selector: Keyword(
                        [
                            KeywordPart {
                                keyword: "keysAndValuesDo:",
                                span: Span {
                                    start: 701,
                                    end: 717,
                                },
                            },
                        ],
                    ),
                    parameters: [
                        ParameterDefinition {
                            name: Identifier {
                                name: "block",
                                span: Span {
                                    start: 718,
                                    end: 723,
                                },
                            },
                            type_annotation: None,
                        },
                    ],
                    body: [
                        ExpressionStatement {
                            comments: CommentAttachment {
                                leading: [],
                                trailing: None,
                            },
                            expression: Primitive {
                                name: "keysAndValuesDo:",
                                is_quoted: true,
                                is_intrinsic: false,
                                span: Span {
                                    start: 727,
                                    end: 756,
                                },
                            },
                            preceding_blank_line: false,
                        },
                    ],
                    return_type: None,
                    is_sealed: false,
                    kind: Primary,
                    comments: CommentAttachment {
                        leading: [
                            Comment {
                                content: "Iteration",
                                span: Span {
                                    start: 701,
                                    end: 717,
                                },
                                kind: Line,
                                preceding_blank_line: true,
                            },
                        ],
                        trailing: None,
                    },
                    doc_comment: None,
                    span: Span {
                        start: 701,
                        end: 756,
                    },
                },
            ],
            class_methods: [],
            class_variables: [],
            comments: CommentAttachment {
                leading: [
                    Comment {
                        content: "Copyright 2026 James Casey",
                        span: Span {
                            start: 247,
                            end: 253,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "SPDX-License-Identifier: Apache-2.0",
                        span: Span {
                            start: 247,
                            end: 253,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "Test Dictionary class compilation as a value type (not gen_server).",
                        span: Span {
                            start: 247,
                            end: 253,
                        },
                        kind: Line,
                        preceding_blank_line: true,
                    },
                    Comment {
                        content: "Dictionary is a sealed Object subclass backed by Erlang maps.",
                        span: Span {
                            start: 247,
                            end: 253,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                    Comment {
                        content: "new/0 should return #{} (empty map).",
                        span: Span {
                            start: 247,
                            end: 253,
                        },
                        kind: Line,
                        preceding_blank_line: false,
                    },
                ],
                trailing: None,
            },
            doc_comment: None,
            span: Span {
                start: 247,
                end: 756,
            },
        },
    ],
    method_definitions: [],
    expressions: [],
    span: Span {
        start: 247,
        end: 756,
    },
    file_leading_comments: [],
    file_trailing_comments: [],
}
