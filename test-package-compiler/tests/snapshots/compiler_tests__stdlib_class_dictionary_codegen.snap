---
source: test-package-compiler/tests/compiler_tests.rs
expression: core_erlang
---
module 'stdlib_class_dictionary' ['new'/0, 'new'/1, 'size'/1, 'keys'/1, 'values'/1, 'at:'/2, 'at:ifAbsent:'/3, 'at:put:'/3, 'includesKey:'/2, 'removeKey:'/2, 'merge:'/2, 'keysAndValuesDo:'/2, 'describe'/1, 'dispatch'/3, 'dispatch'/4, 'has_method'/1, 'superclass'/0, 'register_class'/0]
  attributes ['on_load' = [{'register_class', 0}]]

'new'/0 = fun () ->
    ~{}~


'new'/1 = fun (InitArgs) ->
    InitArgs


'size'/1= fun (Self) ->
call 'erlang':'map_size'(Self)

'keys'/1= fun (Self) ->
call 'maps':'keys'(Self)

'values'/1= fun (Self) ->
call 'maps':'values'(Self)

'at:'/2= fun (Self, _key1) ->
call 'maps':'get'(_key1, Self)

'at:ifAbsent:'/3= fun (Self, _key2, _block3) ->
call 'beamtalk_map_ops':'at_if_absent'(Self, _key2, _block3)

'at:put:'/3= fun (Self, _key4, _value5) ->
call 'maps':'put'(_key4, _value5, Self)

'includesKey:'/2= fun (Self, _key6) ->
call 'maps':'is_key'(_key6, Self)

'removeKey:'/2= fun (Self, _key7) ->
call 'maps':'remove'(_key7, Self)

'merge:'/2= fun (Self, _other8) ->
call 'maps':'merge'(Self, _other8)

'keysAndValuesDo:'/2= fun (Self, _block9) ->
call 'beamtalk_map_ops':'keys_and_values_do'(Self, _block9)

'describe'/1= fun (Self) ->
#{#<97>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<68>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<99>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<111>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<114>(8,1,'integer',['unsigned'|['big']]),#<121>(8,1,'integer',['unsigned'|['big']])}#

'dispatch'/3 = fun (Selector, Args, Self) ->
    case Selector of
        <'class'> when 'true' ->
            'Dictionary'
        <'respondsTo:'> when 'true' ->
            case Args of
                <[RtSelector | _]> when 'true' -> call 'stdlib_class_dictionary':'has_method'(RtSelector)
                <_> when 'true' -> 'false'
            end
        <'instVarNames'> when 'true' ->
            []
        <'instVarAt:'> when 'true' ->
            let <IvaErr0> = call 'beamtalk_error':'new'('immutable_value', 'Dictionary') in
            let <IvaErr1> = call 'beamtalk_error':'with_selector'(IvaErr0, 'instVarAt:') in
            let <IvaErr2> = call 'beamtalk_error':'with_hint'(IvaErr1, #{#<68>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<99>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<111>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<114>(8,1,'integer',['unsigned'|['big']]),#<121>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<114>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<109>(8,1,'integer',['unsigned'|['big']]),#<109>(8,1,'integer',['unsigned'|['big']]),#<117>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<98>(8,1,'integer',['unsigned'|['big']]),#<108>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<100>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<104>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<118>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<111>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<99>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<118>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<114>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<98>(8,1,'integer',['unsigned'|['big']]),#<108>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<46>(8,1,'integer',['unsigned'|['big']])}#) in
            call 'beamtalk_error':'raise'(IvaErr2)
        <'instVarAt:put:'> when 'true' ->
            let <ImmErr0> = call 'beamtalk_error':'new'('immutable_value', 'Dictionary') in
            let <ImmErr1> = call 'beamtalk_error':'with_selector'(ImmErr0, 'instVarAt:put:') in
            let <ImmErr2> = call 'beamtalk_error':'with_hint'(ImmErr1, #{#<68>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<99>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<111>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<114>(8,1,'integer',['unsigned'|['big']]),#<121>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<114>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<109>(8,1,'integer',['unsigned'|['big']]),#<109>(8,1,'integer',['unsigned'|['big']]),#<117>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<98>(8,1,'integer',['unsigned'|['big']]),#<108>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<46>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<85>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<103>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<109>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<40>(8,1,'integer',['unsigned'|['big']]),#<120>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']]),#<61>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<119>(8,1,'integer',['unsigned'|['big']]),#<86>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<108>(8,1,'integer',['unsigned'|['big']]),#<117>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<41>(8,1,'integer',['unsigned'|['big']]),#<32>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<100>(8,1,'integer',['unsigned'|['big']]),#<46>(8,1,'integer',['unsigned'|['big']])}#) in
            call 'beamtalk_error':'raise'(ImmErr2)
        <'perform:'> when 'true' ->
            let <PerfSel> = call 'erlang':'hd'(Args) in
            call 'stdlib_class_dictionary':'dispatch'(PerfSel, [], Self)
        <'perform:withArguments:'> when 'true' ->
            let <PwaSel> = call 'erlang':'hd'(Args) in
            let <PwaArgs> = call 'erlang':'hd'(call 'erlang':'tl'(Args)) in
            call 'stdlib_class_dictionary':'dispatch'(PwaSel, PwaArgs, Self)
        <'size'> when 'true' ->
            call 'stdlib_class_dictionary':'size'(Self)
        <'keys'> when 'true' ->
            call 'stdlib_class_dictionary':'keys'(Self)
        <'values'> when 'true' ->
            call 'stdlib_class_dictionary':'values'(Self)
        <'at:'> when 'true' ->
            let <DispArg0> = call 'erlang':'hd'(Args) in
            call 'stdlib_class_dictionary':'at:'(Self, DispArg0)
        <'at:ifAbsent:'> when 'true' ->
            let <DispArg0> = call 'erlang':'hd'(Args) in
            let <DispArg1> = call 'erlang':'hd'(call 'erlang':'tl'(Args)) in
            call 'stdlib_class_dictionary':'at:ifAbsent:'(Self, DispArg0, DispArg1)
        <'at:put:'> when 'true' ->
            let <DispArg0> = call 'erlang':'hd'(Args) in
            let <DispArg1> = call 'erlang':'hd'(call 'erlang':'tl'(Args)) in
            call 'stdlib_class_dictionary':'at:put:'(Self, DispArg0, DispArg1)
        <'includesKey:'> when 'true' ->
            let <DispArg0> = call 'erlang':'hd'(Args) in
            call 'stdlib_class_dictionary':'includesKey:'(Self, DispArg0)
        <'removeKey:'> when 'true' ->
            let <DispArg0> = call 'erlang':'hd'(Args) in
            call 'stdlib_class_dictionary':'removeKey:'(Self, DispArg0)
        <'merge:'> when 'true' ->
            let <DispArg0> = call 'erlang':'hd'(Args) in
            call 'stdlib_class_dictionary':'merge:'(Self, DispArg0)
        <'keysAndValuesDo:'> when 'true' ->
            let <DispArg0> = call 'erlang':'hd'(Args) in
            call 'stdlib_class_dictionary':'keysAndValuesDo:'(Self, DispArg0)
        <'describe'> when 'true' ->
            call 'stdlib_class_dictionary':'describe'(Self)
        <_Other> when 'true' ->
            case call 'beamtalk_extensions':'lookup'('Dictionary', Selector) of
                <{'ok', ExtFun, _ExtOwner}> when 'true' ->
                    apply ExtFun(Args, Self)
                <'not_found'> when 'true' ->
                    call 'bt@stdlib@object':'dispatch'(Selector, Args, Self)
            end
    end


'dispatch'/4 = fun (Selector, Args, Self, State) ->
    try call 'stdlib_class_dictionary':'dispatch'(Selector, Args, Self)
    of <D4Result> -> {'reply', D4Result, State}
    catch <_D4Type, D4Error, _D4Stack> -> {'error', D4Error, State}


'has_method'/1 = fun (Selector) ->
    case call 'lists':'member'(Selector, ['class', 'respondsTo:', 'instVarNames', 'instVarAt:', 'instVarAt:put:', 'perform:', 'perform:withArguments:', 'size', 'keys', 'values', 'at:', 'at:ifAbsent:', 'at:put:', 'includesKey:', 'removeKey:', 'merge:', 'keysAndValuesDo:', 'describe']) of
        <'true'> when 'true' -> 'true'
        <'false'> when 'true' ->
            case call 'beamtalk_extensions':'has'('Dictionary', Selector) of
                <'true'> when 'true' -> 'true'
                <'false'> when 'true' -> call 'bt@stdlib@object':'has_method'(Selector)
            end
    end


'superclass'/0 = fun () -> 'Object'

'register_class'/0 = fun () ->
    try
        let ClassInfo0 = ~{
            'name' => 'Dictionary',
            'module' => 'stdlib_class_dictionary',
            'superclass' => 'Object',
            'is_sealed' => 'true',
            'is_abstract' => 'false',
            'instance_methods' => ~{'size' => ~{'arity' => 0, 'is_sealed' => 'true'}~, 'keys' => ~{'arity' => 0, 'is_sealed' => 'true'}~, 'values' => ~{'arity' => 0, 'is_sealed' => 'true'}~, 'at:' => ~{'arity' => 1, 'is_sealed' => 'true'}~, 'at:ifAbsent:' => ~{'arity' => 2, 'is_sealed' => 'true'}~, 'at:put:' => ~{'arity' => 2, 'is_sealed' => 'true'}~, 'includesKey:' => ~{'arity' => 1, 'is_sealed' => 'true'}~, 'removeKey:' => ~{'arity' => 1, 'is_sealed' => 'true'}~, 'merge:' => ~{'arity' => 1, 'is_sealed' => 'true'}~, 'keysAndValuesDo:' => ~{'arity' => 1, 'is_sealed' => 'true'}~, 'describe' => ~{'arity' => 0, 'is_sealed' => 'true'}~}~,
            'instance_variables' => [],
            'class_methods' => ~{
                'new' => ~{'arity' => 0}~,
                'new:' => ~{'arity' => 1}~,
                'superclass' => ~{'arity' => 0}~
            }~,
            'method_source' => ~{'size' => #{#<115>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<122>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']])}#, 'keys' => #{#<107>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<121>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']])}#, 'values' => #{#<118>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<108>(8,1,'integer',['unsigned'|['big']]),#<117>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']])}#, 'at:' => #{#<97>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']])}#, 'at:ifAbsent:' => #{#<97>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<102>(8,1,'integer',['unsigned'|['big']]),#<65>(8,1,'integer',['unsigned'|['big']]),#<98>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']])}#, 'at:put:' => #{#<97>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']]),#<112>(8,1,'integer',['unsigned'|['big']]),#<117>(8,1,'integer',['unsigned'|['big']]),#<116>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']])}#, 'includesKey:' => #{#<105>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<99>(8,1,'integer',['unsigned'|['big']]),#<108>(8,1,'integer',['unsigned'|['big']]),#<117>(8,1,'integer',['unsigned'|['big']]),#<100>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<75>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<121>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']])}#, 'removeKey:' => #{#<114>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<109>(8,1,'integer',['unsigned'|['big']]),#<111>(8,1,'integer',['unsigned'|['big']]),#<118>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<75>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<121>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']])}#, 'merge:' => #{#<109>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<114>(8,1,'integer',['unsigned'|['big']]),#<103>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']])}#, 'keysAndValuesDo:' => #{#<107>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<121>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<65>(8,1,'integer',['unsigned'|['big']]),#<110>(8,1,'integer',['unsigned'|['big']]),#<100>(8,1,'integer',['unsigned'|['big']]),#<86>(8,1,'integer',['unsigned'|['big']]),#<97>(8,1,'integer',['unsigned'|['big']]),#<108>(8,1,'integer',['unsigned'|['big']]),#<117>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<68>(8,1,'integer',['unsigned'|['big']]),#<111>(8,1,'integer',['unsigned'|['big']]),#<58>(8,1,'integer',['unsigned'|['big']])}#, 'describe' => #{#<100>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']]),#<115>(8,1,'integer',['unsigned'|['big']]),#<99>(8,1,'integer',['unsigned'|['big']]),#<114>(8,1,'integer',['unsigned'|['big']]),#<105>(8,1,'integer',['unsigned'|['big']]),#<98>(8,1,'integer',['unsigned'|['big']]),#<101>(8,1,'integer',['unsigned'|['big']])}#}~,
            'class_variables' => ~{}~
        }~
        in let _Reg0 = case call 'beamtalk_object_class':'start'('Dictionary', ClassInfo0) of
            <{'ok', _Pid0}> when 'true' -> 'ok'
            <{'error', {'already_started', _Existing0}}> when 'true' ->
                let _UpdRes0 = call 'beamtalk_object_class':'update_class'('Dictionary', ClassInfo0) in case _UpdRes0 of
                    <{'ok', _}> when 'true' -> 'ok'
                    <{'error', _UpdErr0}> when 'true' -> {'error', _UpdErr0}
                end
            <{'error', _Reason0}> when 'true' -> 'ok'
        end

        in _Reg0

    of RegResult -> RegResult
    catch <CatchType, CatchError, CatchStack> -> 'ok'


end
