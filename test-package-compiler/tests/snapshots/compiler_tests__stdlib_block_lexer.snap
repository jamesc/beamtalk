---
source: test-package-compiler/tests/compiler_tests.rs
expression: output
---
Token { kind: Identifier("block"), span: Span { start: 140, end: 145 }, leading_trivia: [LineComment("// Copyright 2026 James Casey"), Whitespace("\n"), LineComment("// SPDX-License-Identifier: Apache-2.0"), Whitespace("\n\n"), LineComment("// Test block evaluation and control flow"), Whitespace("\n\n"), LineComment("// Simple block evaluation"), Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 146, end: 148 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: LeftBracket, span: Span { start: 149, end: 150 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Integer("42"), span: Span { start: 150, end: 152 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: RightBracket, span: Span { start: 152, end: 153 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("result"), span: Span { start: 154, end: 160 }, leading_trivia: [Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 161, end: 163 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("block"), span: Span { start: 164, end: 169 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("value"), span: Span { start: 170, end: 175 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("increment"), span: Span { start: 204, end: 213 }, leading_trivia: [Whitespace("\n\n"), LineComment("// Block with one argument"), Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 214, end: 216 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: LeftBracket, span: Span { start: 217, end: 218 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Colon, span: Span { start: 218, end: 219 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("x"), span: Span { start: 219, end: 220 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Pipe, span: Span { start: 221, end: 222 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("x"), span: Span { start: 223, end: 224 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: BinarySelector("+"), span: Span { start: 225, end: 226 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("1"), span: Span { start: 227, end: 228 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: RightBracket, span: Span { start: 228, end: 229 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("result2"), span: Span { start: 230, end: 237 }, leading_trivia: [Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 238, end: 240 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("increment"), span: Span { start: 241, end: 250 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Keyword("value:"), span: Span { start: 251, end: 257 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("5"), span: Span { start: 258, end: 259 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("add"), span: Span { start: 289, end: 292 }, leading_trivia: [Whitespace("\n\n"), LineComment("// Block with two arguments"), Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 293, end: 295 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: LeftBracket, span: Span { start: 296, end: 297 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Colon, span: Span { start: 297, end: 298 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("x"), span: Span { start: 298, end: 299 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Colon, span: Span { start: 300, end: 301 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("y"), span: Span { start: 301, end: 302 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Pipe, span: Span { start: 303, end: 304 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("x"), span: Span { start: 305, end: 306 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: BinarySelector("+"), span: Span { start: 307, end: 308 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("y"), span: Span { start: 309, end: 310 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: RightBracket, span: Span { start: 310, end: 311 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("result3"), span: Span { start: 312, end: 319 }, leading_trivia: [Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 320, end: 322 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("add"), span: Span { start: 323, end: 326 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Keyword("value:"), span: Span { start: 327, end: 333 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("3"), span: Span { start: 334, end: 335 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Keyword("value:"), span: Span { start: 336, end: 342 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("4"), span: Span { start: 343, end: 344 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("counter"), span: Span { start: 360, end: 367 }, leading_trivia: [Whitespace("\n\n"), LineComment("// While loop"), Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 368, end: 370 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("0"), span: Span { start: 371, end: 372 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: LeftBracket, span: Span { start: 373, end: 374 }, leading_trivia: [Whitespace("\n")], trailing_trivia: [] }
Token { kind: Identifier("counter"), span: Span { start: 374, end: 381 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: BinarySelector("<"), span: Span { start: 382, end: 383 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("5"), span: Span { start: 384, end: 385 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: RightBracket, span: Span { start: 385, end: 386 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Keyword("whileTrue:"), span: Span { start: 387, end: 397 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: LeftBracket, span: Span { start: 398, end: 399 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("counter"), span: Span { start: 399, end: 406 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 407, end: 409 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("counter"), span: Span { start: 410, end: 417 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: BinarySelector("+"), span: Span { start: 418, end: 419 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("1"), span: Span { start: 420, end: 421 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: RightBracket, span: Span { start: 421, end: 422 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("outer"), span: Span { start: 452, end: 457 }, leading_trivia: [Whitespace("\n\n"), LineComment("// Block captures variables"), Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 458, end: 460 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("10"), span: Span { start: 461, end: 463 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("captureBlock"), span: Span { start: 464, end: 476 }, leading_trivia: [Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 477, end: 479 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: LeftBracket, span: Span { start: 480, end: 481 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("outer"), span: Span { start: 481, end: 486 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: BinarySelector("+"), span: Span { start: 487, end: 488 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Integer("5"), span: Span { start: 489, end: 490 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: RightBracket, span: Span { start: 490, end: 491 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Identifier("result4"), span: Span { start: 492, end: 499 }, leading_trivia: [Whitespace("\n")], trailing_trivia: [Whitespace(" ")] }
Token { kind: Assign, span: Span { start: 500, end: 502 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("captureBlock"), span: Span { start: 503, end: 515 }, leading_trivia: [], trailing_trivia: [Whitespace(" ")] }
Token { kind: Identifier("value"), span: Span { start: 516, end: 521 }, leading_trivia: [], trailing_trivia: [] }
Token { kind: Eof, span: Span { start: 522, end: 522 }, leading_trivia: [Whitespace("\n")], trailing_trivia: [] }
